<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kami Flex ‚Äî Fake Number AF</title>
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans", sans-serif;
      background: #071024;
      color: #eef2ff;
      display: flex;
      justify-content: center;
      padding: 20px;
    }
    .card {
      width: 100%;
      max-width: 500px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.06);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.5);
    }
    h1 { margin:0 0 15px 0; font-size:22px; text-align:center; }
    #numberBox {
      font-size: 20px;
      background: rgba(0,0,0,0.25);
      padding: 12px;
      border-radius: 8px;
      text-align:center;
      margin-bottom: 12px;
    }
    .row { display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-bottom:10px;}
    button {
      padding: 10px 14px;
      border-radius:8px;
      border:none;
      cursor:pointer;
      background:#5b6cff;
      color:white;
      font-weight:600;
    }
    button.secondary { background:transparent; border:1px solid rgba(255,255,255,0.12); color:#eef2ff; }
    #loader { display:none; text-align:center; margin:10px 0; }
    #otpBox {
      margin-top:12px;
      background: rgba(0,0,0,0.12);
      padding:12px;
      border-radius:8px;
      min-height:50px;
      text-align:center;
      font-weight:700;
      font-size:18px;
      color:#b7ff6a;
    }
    .notice { 
      padding:10px; 
      background:rgba(255,255,255,0.03); 
      border-radius:8px; 
      margin-top:10px; 
      color:#ffd; 
      border:1px solid rgba(255,255,255,0.03);
      text-align:center;
      font-size:14px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>üéØ Kami Flex Fake Number AF</h1>
    <div id="numberBox">Press "Generate Number"</div>
    <div class="row">
      <button id="generateBtn">Generate Number</button>
      <button id="clearBtn" class="secondary">Clear</button>
      <button id="refreshBtn">Refresh OTP</button>
      <button id="copyBtn" class="secondary">Copy OTP</button>
    </div>
    <div id="loader">‚è≥ Loading...</div>
    <div id="otpBox">OTP will appear here</div>
    <div id="infoBox" class="notice">First generate a number to start</div>
  </div>

<script>
let currentNumber = '';
let currentOtp = '';

const numberBox = document.getElementById('numberBox');
const otpBox = document.getElementById('otpBox');
const loader = document.getElementById('loader');
const infoBox = document.getElementById('infoBox');

function setLoading(state) {
  loader.style.display = state ? 'block' : 'none';
}

// Generate Number
document.getElementById('generateBtn').addEventListener('click', async ()=>{
  setLoading(true);
  numberBox.textContent = 'Generating...';
  infoBox.style.display = 'none';
  try{
    const res = await fetch('/api/fake?type=number&country=AF');
    const data = await res.json();
    if(data && data.number){
      currentNumber = data.number;
      numberBox.textContent = 'üìû ' + currentNumber;
      otpBox.textContent = data.otp || '';
      currentOtp = data.otp || '';
    } else {
      numberBox.textContent = '‚ùå Failed';
      infoBox.textContent = 'Could not generate number, try again.';
      infoBox.style.display = 'block';
    }
  }catch(e){
    numberBox.textContent = '‚ö†Ô∏è Error';
    infoBox.textContent = e.message || e;
    infoBox.style.display = 'block';
  } finally { setLoading(false); }
});

// Refresh OTP
document.getElementById('refreshBtn').addEventListener('click', async ()=>{
  if(!currentNumber) return alert('Generate a number first');
  setLoading(true);
  try{
    const res = await fetch('/api/fake?type=otp&number=' + encodeURIComponent(currentNumber));
    const data = await res.json();
    currentOtp = data.otp || '';
    otpBox.textContent = currentOtp || 'No OTP yet';
  }catch(e){ otpBox.textContent = '‚ö†Ô∏è Error fetching OTP'; }
  finally{ setLoading(false); }
});

// Clear
document.getElementById('clearBtn').addEventListener('click', ()=>{
  currentNumber=''; currentOtp='';
  numberBox.textContent='Press "Generate Number"';
  otpBox.textContent='OTP will appear here';
  infoBox.style.display='block';
  infoBox.textContent='First generate a number to start';
});

// Copy OTP
document.getElementById('copyBtn').addEventListener('click', async ()=>{
  if(!currentOtp) return alert('No OTP to copy');
  try{
    await navigator.clipboard.writeText(currentOtp);
    alert('OTP copied: ' + currentOtp);
  }catch(e){ alert('Failed to copy'); }
});
</script>
</body>
</html>
