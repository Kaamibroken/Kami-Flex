<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kami Flex Fake Number</title>
<style>
:root{--bg:#071a2a;--card:rgba(255,255,255,0.04);--muted:#9aa4b2;--accent:#06b6d4}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",sans-serif;background:var(--bg);color:#eef2ff;margin:0;padding:20px;display:flex;justify-content:center}
.container{max-width:900px;width:100%;}
.card{background:var(--card);padding:18px;border-radius:12px;margin-bottom:18px;box-shadow:0 6px 20px rgba(0,0,0,0.4)}
h1{margin:0 0 12px;font-size:24px}
.row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
button{padding:10px 14px;border-radius:8px;border:none;background:var(--accent);color:#042;cursor:pointer}
button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.12);color:#eef2ff}
input,select{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);background:rgba(0,0,0,0.25);color:#eef2ff}
#numberBox{background:rgba(0,0,0,0.25);padding:10px;border-radius:8px;min-width:200px}
.item{display:flex;justify-content:space-between;align-items:center;padding:10px;background:rgba(255,255,255,0.02);border-radius:8px;margin-bottom:6px}
.copyBtn{padding:6px 10px;background:#173644;color:#cfe8ea;border:0;border-radius:6px;cursor:pointer}
.otp{font-weight:700;color:#b7ff6a;margin-left:10px}
.small{font-size:13px;color:#9aa4b2}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h1>ðŸŽ¯ Kami Flex â€” Fake Number</h1>
    <div class="row">
      <select id="countrySelect"><option>Loading countries...</option></select>
      <input id="carrierInput" placeholder="Carrier (optional)" />
      <button id="getNumberBtn">Get Number</button>
      <div id="numberBox">Number will appear here</div>
    </div>
  </div>

  <div class="card">
    <h3>Generated Numbers</h3>
    <div id="numberList"></div>
  </div>
</div>

<script>
const countrySelect = document.getElementById('countrySelect');
const carrierInput = document.getElementById('carrierInput');
const getNumberBtn = document.getElementById('getNumberBtn');
const numberBox = document.getElementById('numberBox');
const numberList = document.getElementById('numberList');

// helper API call
async function api(params = {}) {
  const url = '/api/fake?' + new URLSearchParams(params).toString();
  const res = await fetch(url);
  const text = await res.text();
  try { return JSON.parse(text); } catch(e){ return text; }
}

// load countries
async function loadCountries(){
  const data = await api({type:'countries'});
  countrySelect.innerHTML = '';
  if(Array.isArray(data)){
    data.forEach(c=>{
      const opt = document.createElement('option');
      opt.value = c.id || c.code || c.name;
      opt.textContent = c.name || c.country || c.id;
      countrySelect.appendChild(opt);
    });
  } else {
    countrySelect.innerHTML='<option>All Countries</option>';
  }
}

// get number
async function getNumber(){
  const country = countrySelect.value;
  const carrier = carrierInput.value;
  numberBox.textContent='Generating...';
  const data = await api({type:'number', app:'global--AF-93', carrier});
  let num = '';
  if(data){
    if(typeof data==='string'){
      const m = data.match(/\+?\d{6,15}/);
      if(m) num=m[0];
    } else {
      num=data.number || data.phone || '';
    }
  }
  numberBox.textContent=num||'No number';
  // add to list
  const div = document.createElement('div');
  div.className='item';
  div.innerHTML=`<div>${num || '-'}</div>`;
  const copyBtn = document.createElement('button');
  copyBtn.className='copyBtn'; copyBtn.textContent='Copy';
  copyBtn.onclick = ()=>{navigator.clipboard.writeText(num);copyBtn.textContent='Copied';setTimeout(()=>copyBtn.textContent='Copy',1200);}
  div.appendChild(copyBtn);
  numberList.prepend(div);
}

getNumberBtn.addEventListener('click', getNumber);

// initial load
loadCountries();
</script>
</body>
</html>
