<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kami Flex Fake Number</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body { background:#071a2a; color:white; font-family:sans-serif; }
    .kami-title {
      font-size:28px; font-weight:bold;
      background:linear-gradient(90deg,#06b6d4,#9333ea);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      text-align:center; margin-bottom:20px;
    }
    .card {
      background:rgba(255,255,255,0.05);
      border-radius:15px; padding:20px; max-width:400px; margin:auto;
      box-shadow:0 0 20px rgba(6,182,212,0.3);
    }
    .error { color:#ff4d4d; font-weight:bold; }
  </style>
</head>
<body class="p-6">

  <h1 class="kami-title">Kami Flex Fake Number</h1>

  <div class="card space-y-4">
    <!-- Country -->
    <select id="country" class="w-full p-2 rounded text-black" onclick="loadCountries()">
      <option value="">Select Country</option>
    </select>

    <!-- Carrier -->
    <select id="carrier" class="w-full p-2 rounded text-black" onclick="loadCarriers()">
      <option value="">Select Carrier</option>
    </select>

    <!-- Buttons -->
    <button onclick="generateNumber()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 px-4 py-2 rounded text-white font-bold">üì± Generate Number</button>
    <button onclick="checkOtp()" class="w-full bg-gradient-to-r from-green-500 to-teal-600 px-4 py-2 rounded text-white font-bold">üîë Check OTP</button>

    <!-- Result -->
    <div id="result" class="mt-4 p-3 bg-black rounded text-sm">No number yet</div>
    <button onclick="copyResult()" class="mt-2 px-4 py-2 bg-pink-600 rounded text-white">üìã Copy</button>
  </div>

  <!-- fake.js include -->
  <script src="js/fake.js"></script>

  <script>
    async function loadCountries() {
      const countrySelect = document.getElementById("country");
      if (countrySelect.options.length > 1) return;

      countrySelect.innerHTML = "<option>Loading...</option>";
      try {
        const countries = await handler("countries");
        if (!countries || countries.length === 0) throw new Error("No countries found");
        countrySelect.innerHTML = '<option value="">Select Country</option>';
        countries.forEach(c => {
          const opt = document.createElement("option");
          opt.value = c.code;
          opt.textContent = c.name;
          countrySelect.appendChild(opt);
        });
      } catch (err) {
        countrySelect.innerHTML = `<option class="error">‚ùå Error loading countries</option>`;
        console.error(err);
      }
    }

    async function loadCarriers() {
      const carrierSelect = document.getElementById("carrier");
      if (carrierSelect.options.length > 1) return;

      carrierSelect.innerHTML = "<option>Loading...</option>";
      try {
        const carriers = await handler("carriers");
        if (!carriers || carriers.length === 0) throw new Error("No carriers found");
        carrierSelect.innerHTML = '<option value="">Select Carrier</option>';
        carriers.forEach(c => {
          const opt = document.createElement("option");
          opt.value = c.id;
          opt.textContent = c.name;
          carrierSelect.appendChild(opt);
        });
      } catch (err) {
        carrierSelect.innerHTML = `<option class="error">‚ùå Error loading carriers</option>`;
        console.error(err);
      }
    }

    async function generateNumber() {
      const result = document.getElementById("result");
      result.innerText = "‚è≥ Generating...";
      try {
        const data = await handler("number");
        if (!data) throw new Error("No number returned");
        result.innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        result.innerHTML = `<span class="error">‚ùå Failed to generate number</span>`;
        console.error(err);
      }
    }

    async function checkOtp() {
      const result = document.getElementById("result");
      result.innerText = "‚è≥ Fetching OTP...";
      try {
        const data = await handler("otp");
        if (!data) throw new Error("No OTP returned");
        result.innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        result.innerHTML = `<span class="error">‚ùå Failed to fetch OTP</span>`;
        console.error(err);
      }
    }

    function copyResult() {
      const text = document.getElementById("result").innerText;
      navigator.clipboard.writeText(text);
      alert("Copied: " + text);
    }
  </script>
</body>
</html>
